<h2 id="deepfret">DeepFRET</h2>
<p>A fully open-source, all-inclusive software platform for doing total internal reflection microscopy (TIRFm) single molecule FRET (smFRET) fast and efficiently. The key feature is reverse-loading of ASCII traces, and <em>Keras/TensorFlow-powered automatic trace sorting</em>. Features include</p>
<ul>
<li>Advanced trace sorting</li>
<li>Optical correction factors</li>
<li>Hidden Markov model fitting and lifetime plotting</li>
<li>Memory-free movie batch loading</li>
<li>Distribution plotting and fitting</li>
<li>Simulation of smFRET data</li>
<li>Backwards-compatibility with iSMS-exported data</li>
</ul>
<p>If you’d like to play around with just the Keras/TensorFlow model, please go to <a href="https://github.com/komodovaran/DeepFRET-Model" class="uri">https://github.com/komodovaran/DeepFRET-Model</a></p>
<h2 id="how-to-cite">How to cite</h2>
<p><em>Publication coming soon!</em></p>
<h2 id="installing-and-running-the-software">1. Installing and running the software</h2>
<h3 id="launching-the-deepfret-gui-from-executable">Launching the DeepFRET GUI from executable</h3>
<p>Download the pre-compiled version <a href="https://drive.google.com/open?id=1jwTls9Yf2hwd1JHfd31-d6NvUVzrOXtJ">here</a>.</p>
<p>(Note: currently only available for MacOS)</p>
<h3 id="launching-deepfret-gui-from-python-source-code.">Launching DeepFRET GUI from Python source code.</h3>
<ol type="1">
<li><p>Install Python 3.7.0. Other versions <em>might</em> work, but this is not guaranteed.</p></li>
<li><p>Download repository contents, by cloning the repository or unzipping the zip file, and open the folder in the terminal.</p></li>
<li><p>Create a <a href="https://packaging.python.org/guides/installing-using-pip-and-virtual-environments/">virtual environment</a> environment with <code>python3 -m venv venv</code> in the current directory.</p></li>
<li><p>Activate environment with <code>source venv/bin/activate</code> if on MacOS/Linux or <code>call venv\scripts\activate.bat</code> if on Windows.</p></li>
<li><p>While still in the environment, install all dependencies with <code>pip install -r requirements.txt</code></p></li>
<li><p>Launch the GUI with <code>python3 src/main/python/main.py</code> or <code>python src/main/python/main.py</code>, depending on the setup of your environment.</p></li>
</ol>
<h2 id="loading-data">2. Loading data</h2>
<ol type="1">
<li>To load videos, open the application’s main window (‘Images’)</li>
</ol>
<p><img src="screenshots/window_images.png" height="300"></p>
<p>and go to File → Open files. The current version of DeepFRET supports <em>only</em> videos made with alternating laser excitation (ALEX). Donor order and appearance can be set in Preferences. The rest of the video layout is auto-guessed by the software and doesn’t allow for fine-tuning, so be sure to set up new experiments properly!</p>
<p><img src="screenshots/donor_acceptor_prefs.png" height="500"></p>
<ol start="2" type="1">
<li><p>If you would like to extract traces from a large number of videos that don’t fit into memory, you can tick the ‘batch mode’ option in Preferences, as well as set a number of detections per movie. This disables the option to interactively re-run spot detection analysis, but allows the software to process an essentially unlimited number of videos.</p></li>
<li><p>If you’ve already exported a lot of smFRET traces from another software, but want to do your analysis in DeepFRET, you can even load in traces directly, without movies. Simply make sure that the trace window (‘Traces’) is the active window, and follow the same steps as above for loading data. This works both for traces with and without ALEX.</p></li>
</ol>
<p><img src="screenshots/window_traces.png" height="300"></p>
<h2 id="classifying-the-data">3. Classifying the data</h2>
<ol type="1">
<li>Go to Analyze → Predict to predict the trace type using deep learning. A confidence score will be given for each trace, which tells you how certain the model is that this is a true smFRET trace.</li>
</ol>
<p><img src="screenshots/classification.png" height="300"></p>
<ol start="2" type="1">
<li>To sort traces by different things, go to the View menu. The option “advanced sort” includes, among other things, a lower confidence threshold.</li>
</ol>
<p><img src="screenshots/sorting.png" height="200"></p>
<h2 id="statistical-analysis">4. Statistical analysis</h2>
<ol type="1">
<li><p>To get an overview of data distributions, go to Windows → Histogram. This also allows to fit the FRET distribution with gaussians to estimate the number of underlying conformational states. These plots update with the number of traces selected. Because a large number of operations have to be re-computed every time a trace is selected/de-selected, it can be a bit slow if the window is left open while traces are being selected.</p></li>
<li><p>Additionally, DeepFRET includes a Hidden Markov model with the possibility to fit each trace individually (as a smoothing, “step-finding” method), as well as a global fit option, for a true Hidden Markov model fit. This also automatically fits transition lifetimes and plots transition density plots (which can be found in Windows → Transition Density Plot). One can base the model on the donor/acceptor signal, or directly on the FRET signal (though this is less accurate)</p></li>
</ol>
<h2 id="export-options">5. Export options</h2>
<p>Export plot automatically exports the current plot for each window. If desired, one can also export the data present in each window such as traces, histogram datapoints, etc. available from the File menu.</p>
<h2 id="modifying-and-compiling-deepfret-from-source">6. Modifying and compiling DeepFRET from source</h2>
<p>Note that this is not necessary to make changes. You can still run the source without compiling it. This step is only to create a portable, standalone executable.</p>
<ol type="1">
<li>Follow all steps for launching DeepFRET, above.</li>
<li>Unzip the <code>hooks.zip</code> and overwrite the files in <code>venv/lib/python3.7/site-packages/PyInstaller/hooks/</code>.</li>
<li>Run <code>compile.py</code> and wait until the script finishes.</li>
</ol>
<p>If the above steps worked, you can now edit any part of the code, and re-compile it.</p>
<p>Most interface elements are arranged in the <code>.ui</code> files, and can be edited through <a href="https://www.qt.io/offline-installers">Qt Creator</a> and then converted to Python files with <code>generate_ui.py</code>.</p>
